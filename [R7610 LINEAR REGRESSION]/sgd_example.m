% reference: https://zhuanlan.zhihu.com/p/27442786

%% ??  
close all; clear; clc
X=[40.10 63.50 65.13 80.15 85.62 91.22 95.56 98.36 100.56 120.32]';
Y=[39.86 65.99 64.98 80.10 85.65 92.11 95.10 99.12 101.23 119.85]';

%% ????????
theta = zeros(2, 1); % ???????
%theta = 2*ones(2, 1);
% ??????????
iterations = 100; % ??????
alpha = 0.0001; % ?????
[m,n] = size(X);  % ????????? 
XX = [ones(m, 1), X]; % ???X?????????1????
J = sum((XX * theta - Y).^2) / (2*m)     % ???????

%% ???????????????????theta
J_history = zeros(iterations, 1);
for iter = 1:iterations % ????while??????????????????????
  theta = theta - alpha * 1/m * (XX' * (XX * theta - Y))
    % Save the cost J in every iteration    
    J_history(iter) = sum((XX * theta - Y).^2) / (2*m);     % XX(10,2)  theta(2,1)
end

%% ?????????????
J = sum((XX * theta - Y).^2) / (2*m)     % ????

plot(X,Y,'ro')
hold on
x=[30:.1:130]';
[x_m,x_n]=size(x);
xx=[ones(x_m,1), x];    %??????1???
y=xx*theta;
plot(x,y)
grid on